import binascii, struct
base = 0x5A1100
hexstr = """6aff68bc609a0064a100000000506489250000000083ec10535556578bf98b6c243c8b7424348b5c243033c03805c04eb0008944242874178b461050555368447e9d006affe83633200083c41433c03bd8755c89442414894424188944241c894424308d442430bb01000000508d4c2414885c242ce8c630000085f68b4c24385551518bc48964243c89307403015e088b178d44241c508bcfff521c8b44241485c0745050e87886eeff83c404eb458d4c2430518d542440528d8fb8000000e89c1f00008b87bc0000008b4c243c3bc8742285f68b4424385550518bc48964243c89307404834608018b1783c110518bcfff521c83c8ff85f689442428740c01460875078b068bceff50088b4c24205f5e5d64890d000000005b83c41cc210006aff68f9609a0064a100000000506489250000000083ec2053555657894c24108b0d40f0d10033db68d87e9d00895c243c894c2418e8a6bc1c000fb774244c8b6c24448b45003bf0c644243801743f3bc37410565068bc7e9d0053e80032200083c410897500895d048b450c8b48048d7508518bcee8f62f00008b46048940048b4604895e0889008b76048976080fb74424508b7424403bf389442420897424247404834608013bf3894424188974241c7404834608018d5424188d7d08528d44242c508bcfc644244003897c2454e88c2e00003bf3c644243802740d834608ff75078b168bceff52083bf3c644243801740d834608ff75078b068bceff50088b46100145040fb74c24548b45103bc10f8593010000803dc04eb0000074138b4d00505168907e9d0053e83131200083c4106a18e83985eeff8bf083c404897424503bf3c64424380474268b5d048bcee8db9ee8ff53c706007b9d00895e10ff1528659c0083c40489460cc64614018bde33f63bde895c24547404834308018b4d0c8b013bc1c644243805897424500f847d0000008b50108b4a108b520c8b7b0c8bf28b54245003fa8bd1c1e902f3a58bca83e103f3a48b48108b4910014c24508078150075408b480880791500751c8bc18b0880791500752d8d9b000000008bc18b088079150074f6eb1b8b48048079150075103b4108750b8bc18b49048079150074f08bc13b450c75898b7c244c33f63bde8b54244852518bc48964245889187404834308018b4c2418e8cfecffff8975008975048b47048b4804518bcfe82b2e00003bde8b47048940048b470489770889008b4704894008c644243801740d834308ff75078b138bcbff52088b7424408b4c2414c644243800e84fba1c0083c8ff0146088944243875078b168bceff52088b4c24305f5e5d64890d000000005b83c42cc21800803dc04eb0000074c1500fb744245451508b45005068647e9d0053e8972f200083c418eba5cccc"""
code = binascii.unhexlify(hexstr)

def s32(b):
    return struct.unpack('<i', b)[0]

hits=[]
for i in range(len(code)-5):
    if code[i]==0xE8:
        rel=s32(code[i+1:i+5])
        src=base+i
        dst=src+5+rel
        hits.append((src,dst))

print('CALL count',len(hits))
for src,dst in hits:
    if dst==0x59E210:
        print('CALLS 0x59E210 at',hex(src))

uniq=sorted(set(dst for _,dst in hits))
print('unique call targets',len(uniq))
for dst in uniq:
    if 0x590000 <= dst <= 0x5B0000:
        print('0x5x target',hex(dst))
